<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Session | PatternPath</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        background: '#121312',
                        surface: '#1a1b1a',
                        primary: { DEFAULT: '#ad0013', hover: '#8a000f' },
                        secondary: { DEFAULT: '#a67d43', dim: 'rgba(166, 125, 67, 0.15)' },
                        textPrimary: '#ededed',
                        textSecondary: 'rgba(237, 237, 237, 0.7)',
                        editor: '#0d0d0d',
                    },
                    fontFamily: { mono: ['"JetBrains Mono"', 'monospace'] }
                }
            }
        }
    </script>
    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #121312; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }

        .cursor-blink { animation: blink 1s step-end infinite; }
        @keyframes blink { 50% { opacity: 0; } }
        
        .code-syntax-keyword { color: #a67d43; } 
        .code-syntax-func { color: #dcdcaa; }
        .code-syntax-string { color: #ce9178; }
        .code-syntax-comment { color: #6a9955; font-style: italic; }
        
        /* Prevent outline on editable div */
        [contenteditable]:focus { outline: none; }
    </style>
</head>
<body class="bg-background text-textPrimary font-mono antialiased h-screen flex flex-col overflow-hidden">

    <header class="h-14 border-b border-white/5 bg-surface flex items-center justify-between px-6 shrink-0">
        <div class="flex items-center gap-4">
            <span class="font-bold tracking-tighter text-lg">Pattern<span class="text-primary">Path</span>_Shell</span>
            <div class="h-4 w-px bg-white/10"></div>
            <div class="flex items-center gap-2 px-3 py-1 rounded-full bg-red-900/20 border border-red-900/50">
                <div class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></div>
                <span class="text-[10px] uppercase font-bold text-red-400 tracking-wider">REC â€¢ Live</span>
            </div>
        </div>

        <div class="flex items-center gap-6">
            <div class="text-xl font-bold font-mono" id="timer">45:00</div>
            <button onclick="endSession()" class="px-4 py-1.5 border border-red-500/30 text-red-400 text-xs hover:bg-red-500/10 transition-colors rounded uppercase tracking-widest">
                End Session
            </button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        
        <div class="w-2/5 flex flex-col border-r border-white/5">
            
            <div class="h-1/2 p-6 overflow-y-auto border-b border-white/5 bg-surface/50">
                <div class="flex justify-between items-start mb-4">
                    <h2 class="text-xl font-bold text-white">Invert Binary Tree</h2>
                    <span class="text-xs text-green-400 border border-green-400/30 px-2 py-0.5 rounded bg-green-400/10">EASY</span>
                </div>
                <p class="text-sm text-textSecondary leading-relaxed mb-4">
                    Given the root of a binary tree, invert the tree, and return its root.
                </p>
                <div class="bg-black/30 p-4 rounded border border-white/5 mb-4">
                    <p class="text-xs text-textMuted mb-2 uppercase tracking-wide">Example 1:</p>
                    <code class="text-xs block text-textSecondary">
                        Input: root = [4,2,7,1,3,6,9]<br>
                        Output: [4,7,2,9,6,3,1]
                    </code>
                </div>
            </div>

            <div class="h-1/2 flex flex-col bg-black relative">
                <div class="px-4 py-2 bg-white/5 border-b border-white/5 flex items-center justify-between">
                    <span class="text-xs text-textMuted uppercase tracking-widest">AI_INTERVIEWER.exe</span>
                    <div class="flex gap-1.5">
                        <div class="w-2 h-2 rounded-full bg-white/20"></div>
                        <div class="w-2 h-2 rounded-full bg-white/20"></div>
                    </div>
                </div>

                <div id="chat-history" class="flex-1 p-4 overflow-y-auto space-y-4 font-mono text-sm scroll-smooth">
                    <div class="text-secondary/70 text-xs">[SYSTEM] Connected to Neural Core v4.2...</div>
                    <div class="flex gap-3">
                        <span class="text-primary font-bold shrink-0">> AI:</span>
                        <p class="text-textSecondary">Hello. I've reviewed your resume. Let's start with this Tree problem. Can you explain your initial thought process before you start coding?</p>
                    </div>
                </div>

                <div class="p-3 border-t border-white/10 bg-surface flex gap-2 items-center">
                    <span class="text-green-500">></span>
                    <input id="chat-input" type="text" placeholder="Type response..." class="w-full bg-transparent border-none outline-none text-textPrimary text-sm placeholder-textMuted/30" autocomplete="off">
                </div>
            </div>
        </div>

        <div class="w-3/5 flex flex-col bg-editor">
            
            <div class="flex items-center bg-surface border-b border-white/5 text-xs">
                <div class="px-6 py-3 bg-editor border-t-2 border-primary text-textPrimary flex items-center gap-2">
                    <span class="text-blue-400 text-[10px]">TS</span>
                    Solution.ts
                </div>
                <div class="px-6 py-3 text-textMuted hover:text-textSecondary cursor-pointer transition-colors border-l border-white/5">
                    TreeNode.ts
                </div>
                <div class="flex-1"></div>
            </div>

            <div class="flex-1 flex overflow-hidden relative" onclick="document.getElementById('code-editor').focus()">
                <div class="w-12 bg-surface text-textMuted/30 text-right pr-3 pt-4 text-sm leading-6 select-none border-r border-white/5 font-mono">
                    1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11
                </div>
                
                <div id="code-editor" class="flex-1 p-4 pt-4 text-sm font-mono leading-6 outline-none whitespace-pre" contenteditable="true" spellcheck="false">
<span class="code-syntax-keyword">class</span> Solution {
  <span class="code-syntax-keyword">public</span> <span class="code-syntax-func">invertTree</span>(root: TreeNode | null): TreeNode | null {
    <span class="code-syntax-comment">// Write your logic here</span>
    <span class="code-syntax-keyword">if</span> (!root) <span class="code-syntax-keyword">return</span> <span class="code-syntax-keyword">null</span>;

    <span class="code-syntax-keyword">const</span> temp = root.left;
    root.left = root.right;
    root.right = temp;

    <span class="code-syntax-keyword">this</span>.invertTree(root.left);
    <span class="code-syntax-keyword">this</span>.invertTree(root.right);

    <span class="code-syntax-keyword">return</span> root;
  }
}</div>
            </div>

            <div class="h-16 bg-surface border-t border-white/5 flex items-center justify-end px-6 gap-4">
                <button class="text-textSecondary hover:text-white text-xs uppercase tracking-widest font-bold px-4 py-2 transition-colors">
                    Run Tests
                </button>
                <button class="bg-primary hover:bg-primary-hover text-white text-xs uppercase tracking-widest font-bold px-6 py-2.5 rounded shadow-[0_0_15px_rgba(173,0,19,0.2)] transition-all transform active:scale-95">
                    Submit Solution
                </button>
            </div>
        </div>

    </main>

    <script>
        // 1. COUNTDOWN TIMER
        let timeLeft = 45 * 60; // 45 minutes in seconds
        const timerElement = document.getElementById('timer');

        const timerInterval = setInterval(() => {
            const minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;
            seconds = seconds < 10 ? '0' + seconds : seconds;
            timerElement.textContent = `${minutes}:${seconds}`;
            
            if (timeLeft > 0) {
                timeLeft--;
            } else {
                clearInterval(timerInterval);
                alert("Time's up!");
            }
        }, 1000);

        function endSession() {
            if(confirm("Are you sure you want to end the interview?")) {
                // REDIRECT FIXED: Go back to select-mode menu
                window.location.href = 'select-mode.html'; 
            }
        }

        // 2. CHAT SIMULATION
        const chatInput = document.getElementById('chat-input');
        const chatHistory = document.getElementById('chat-history');

        chatInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter' && chatInput.value.trim() !== "") {
                const userText = chatInput.value;
                
                // Add User Message
                addMessage('YOU', userText, 'text-green-500');
                chatInput.value = '';

                // Simulate AI Thinking and Reply
                setTimeout(() => {
                    const aiResponses = [
                        "That's a valid approach. How does the space complexity look?",
                        "Good. Can you handle the base case where root is null?",
                        "Correct. Please implement that logic in the editor.",
                        "I see a potential syntax error on line 5. Check your types."
                    ];
                    const randomResponse = aiResponses[Math.floor(Math.random() * aiResponses.length)];
                    addMessage('AI', randomResponse, 'text-primary');
                }, 1500);
            }
        });

        function addMessage(sender, text, colorClass) {
            const msgDiv = document.createElement('div');
            msgDiv.className = "flex gap-3 animate-fade-in";
            msgDiv.innerHTML = `
                <span class="${colorClass} font-bold shrink-0">> ${sender}:</span>
                <p class="text-textSecondary">${text}</p>
            `;
            chatHistory.appendChild(msgDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight; // Auto scroll to bottom
        }

        // 3. EDITOR TAB HANDLING (Crucial for coding)
        const editor = document.getElementById('code-editor');

        editor.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                document.execCommand('insertText', false, '  '); // Insert 2 spaces
            }
        });
    </script>

</body>
</html>
